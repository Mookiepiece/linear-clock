var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,l=(e,l)=>{for(var s in l||(l={}))n.call(l,s)&&a(e,s,l[s]);if(t)for(var s of t(l))r.call(l,s)&&a(e,s,l[s]);return e};import{m as s,R as o,D as c,a as i}from"./vendor.0be97831.js";var u={clamp:(e,t=0,n=100)=>Math.max(t,Math.min(n,e)),round2:e=>Math.round(100*e)/100,print(e,t="HM"){const n="number"==typeof e?new Date(e):e;return[n.getHours(),n.getMinutes(),"HMS"===t?n.getSeconds():"null"].filter((e=>"null"!==e)).map((e=>e.toString().padStart(2,"0"))).join(":")}};const m=s(),p=o.createContext({dayStart:0,dayEnd:0,now:0,nowPercentage:0}),d=o.createContext(null);const E=[...Array(24).keys()],f=({startTime:e,endTime:t})=>{const n=((e,t)=>{const[n,r]=["number"==typeof e?new Date(e):e,"number"==typeof t?new Date(t):t],a=new Date(n);return a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),E.filter((e=>(a.setHours(e),a.getTime()>=n.getTime()&&a.getTime()<=r.getTime()))).map((e=>(a.setHours(e),{hour:e,percentage:u.round2((a.getTime()-n.getTime())/(r.getTime()-n.getTime())*100)})))})(e,t),{now:r}=c.exports.useContext(p),a=u.round2((r-e)/(t-e)*100);return o.createElement("div",{className:"rail"},o.createElement("div",{className:"rail__inner"},o.createElement("div",{className:"rail__labels"},n.map((({hour:e,percentage:t})=>o.createElement("div",{key:e,className:"rail__label",style:{left:`${t}%`},"data-hour":e})))),o.createElement("div",{className:"rail__fill",style:{width:`${a}%`}})),o.createElement("div",{className:"time-label"},u.print(r,"HMS")," ",o.createElement("span",{className:"color-primary-d"},"(",u.round2(100-a),"%)")))};const g=()=>{const[[e,t],n]=c.exports.useState([]);return c.exports.useEffect((()=>{m.on("MARK",(e=>n(e))),m.on("UNMARK",(()=>n([])))}),[]),e&&t?o.createElement("div",{className:"focus-rail"},"Focusing (",u.print(e)," - ",u.print(t),")",o.createElement(f,{startTime:e,endTime:t})):null};const v=()=>{const{point2time:e,time2point:t}=c.exports.useContext(d),{now:n}=c.exports.useContext(p),[r,a]=c.exports.useState(null),[s,i]=c.exports.useState(null),[E,g]=c.exports.useState(null),v=c.exports.useRef(null),y=null===r?null:u.round2(100-r);c.exports.useEffect((()=>{s&&E?m.emit("MARK",[s,E]):m.emit("UNMARK",void 0)}),[s,E]);const{dayStart:x,dayEnd:w}=c.exports.useContext(p);return o.createElement("div",{className:"main-rail",onMouseMove:e=>{if(!v.current)throw new Error;const{left:t,width:n}=v.current.getBoundingClientRect(),{clientX:r}=e,l=u.clamp(u.round2((r-t)/n*100));a(l)},onMouseLeave:()=>{a(null)},onClick:t=>{if(!v.current)throw new Error;const{left:r,width:a}=v.current.getBoundingClientRect(),{clientX:l}=t,o=u.clamp(u.round2((l-r)/a*100)),c=e(o);if([s,E].includes(c))return i(null),void g(null);n>c?i(c):g(c)},ref:v},o.createElement(f,{startTime:x,endTime:w}),null===r?null:o.createElement("div",{className:"dial",style:l({left:`${r}%`},{"--label-offset":r>80?"-200px":"4px"})},o.createElement("div",{className:"dial__label"},u.print(e(r))," ",o.createElement("span",{className:"color-primary-d"},"(",y,"%)"))),null===s?null:o.createElement("div",{className:"startmark",style:{left:`${t(s)}%`}}),null===E?null:o.createElement("div",{className:"endmark",style:{left:`${t(E)}%`}}))};const y=(e=0,t=0,n=0,r=0)=>{const a=new Date;return a.setHours(+e,+t,+n,+r),a.getTime()},x=()=>{const[e,t]=c.exports.useState((()=>{const e=new Date;return e.setHours(8,0,0,0),e.getTime()})),[n,r]=c.exports.useState((()=>{const e=new Date;return e.setHours(22,30,0,0),e.getTime()})),[a,l]=c.exports.useState((()=>new Date));c.exports.useEffect((()=>{const e=setInterval((()=>l((()=>new Date))),1e3);return()=>clearInterval(e)}),[]);const s=a.getTime(),i=n-e,m=c.exports.useCallback((t=>t/100*i+e),[i,e]),E=c.exports.useCallback((t=>u.clamp(u.round2((t-e)/i*100))),[e,i]),f=E(s),x=c.exports.useMemo((()=>({point2time:m,time2point:E})),[m,E]);return o.createElement("div",{className:"clock"},o.createElement(p.Provider,{value:{dayStart:e,dayEnd:n,now:s,nowPercentage:f}},o.createElement(d.Provider,{value:x},o.createElement(v,null),o.createElement("div",{style:{paddingTop:16}},o.createElement("input",{type:"time",onChange:e=>t(y(...e.target.value.split(":")))}),o.createElement("input",{type:"time",onChange:e=>r(y(...e.target.value.split(":")))})),o.createElement(g,null))))};const w=()=>o.createElement(x,null);i.render(o.createElement(w,null),document.getElementById("app"));
